import{r as v}from"./index2-D2jTFKj3.js";var X={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et=v,ot=Symbol.for("react.element"),nt=Symbol.for("react.fragment"),rt=Object.prototype.hasOwnProperty,st=et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,it={key:!0,ref:!0,__self:!0,__source:!0};function U(m,t,e){var r,o={},i=null,s=null;e!==void 0&&(i=""+e),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)rt.call(t,r)&&!it.hasOwnProperty(r)&&(o[r]=t[r]);if(m&&m.defaultProps)for(r in t=m.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:ot,type:m,key:i,ref:s,props:o,_owner:st.current}}F.Fragment=nt;F.jsx=U;F.jsxs=U;X.exports=F;var A=X.exports;(function(m,t){!m||m.getElementById("livereloadscript")||(t=m.createElement("script"),t.async=1,t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",m.getElementsByTagName("head")[0].appendChild(t))})(self.document);function O(m){let t=null,e=0;for(const r of m)e==0&&(t=r),r!=t?e--:e++;return t}function ct(m){const[t,e,r,o]=m;let i="#";const s=t.toString(16),n=e.toString(16),l=r.toString(16);if(i+=s.length>1?s:`0${s}`,i+=n.length>1?n:`0${n}`,i+=l.length>1?l:`0${l}`,typeof o<"u"&&m.length>3){const u=Math.round(o*255).toString(16);i+=u.length>1?u:`0${u}`}return i}function N(m){let t=m[0]/255,e=m[1]/255,r=m[2]/255,o,i,s;return t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,o=(t*.4124+e*.3576+r*.1805)/.95047,i=(t*.2126+e*.7152+r*.0722)/1,s=(t*.0193+e*.1192+r*.9505)/1.08883,o=o>.008856?Math.pow(o,.3333333333333333):7.787*o+.13793103448275862,i=i>.008856?Math.pow(i,.3333333333333333):7.787*i+.13793103448275862,s=s>.008856?Math.pow(s,.3333333333333333):7.787*s+.13793103448275862,[116*i-16,500*(o-i),200*(i-s)]}var at=class f{constructor(t){const{origin:e,mockMovePx:r=30,boundaryValue:o=10,ParticleSize:i=10,width:s,height:n,onload:l}=t||{};if(e){if((e instanceof ImageBitmap||e instanceof HTMLImageElement)&&(!s||!n))throw new Error("Because of origin is not a http link, width and height is necessary ")}else throw new Error("Origin is necessary");this.onload=l,f.ParticleSize=i,f.mockMovePx=r,f.boundaryValue=o,this.init(e,s,n).catch(u=>{console.error(u)}).then(()=>{this.onload&&this.onload()})}init(t,e,r){return new Promise((o,i)=>{if(typeof t=="string"){const s=new Image;if(s.src=t,s.crossOrigin="Anonymous",s.onload=()=>{const n=e||s.width,l=r||n/s.width*s.height;this.initCanvas(s,n,l),o(!0)},s.complete){const n=e||s.width,l=r||n/s.width*s.height;this.initCanvas(s,n,l),o(!0)}}else t instanceof ImageBitmap?(this.initCanvas(t,e,r),o(!0)):t instanceof HTMLImageElement?(this.initCanvas(t,e,r),o(!0)):i(new Error("The origin format is not supported"))})}initCanvas(t,e,r){try{this.canvas=new OffscreenCanvas(e,r),this.ctx=this.canvas.getContext("2d"),this.ctx&&this.ctx.drawImage(t,0,0,e,r),this.imageData=this.ctx&&this.ctx.getImageData(0,0,e,r)}catch(o){throw new Error(o)}}pickColor(t,e){return f.getRGB(this.imageData.data,t,e,this.canvas.width)}pickLineColor({leftTopPosition:t,rightBottomPosition:e,scopes:r}){const o=this.imageData.data,i={},s={top:this.getArrayFromTopLine(t,e),left:this.getArrayFromLeftLine(t,e),right:this.getArrayFromRightLine(t,e),bottom:this.getArrayFromBottomLine(t,e)};for(const n in s){if(r&&!r.filter(a=>a===n).length)continue;const l=s[n],u=[];for(const a of l){const c=a[0],h=a[1],[w,g,b]=f.getRGB(o,c,h,this.canvas.width);u.push([w,g,b])}i[n]=f.getMedian(u)}return i}static isAdjust(t,e,r,o){const i=r;let s;if(!o||o==="rgb"){const[n,l,u]=t,[a,c,h]=e,w=(n+a)/2,g=n-a,b=l-c,y=u-h;s=Math.sqrt((2+w/256)*Math.pow(g,2)+4*Math.pow(b,2)+(2+(255-w)/256)*Math.pow(y,2))}else if(o==="lab"){const n=N(t),l=N(e),[u,a,c]=n,[h,w,g]=l;s=Math.sqrt(Math.abs(Math.pow(u-h,2)+Math.pow(a-w,2)+Math.pow(c-g,2)))}return s>=i}static compare(t,e,r,o){return!f.isAdjust(t,e,r||f.boundaryValue,o)}static getAverage(t){const e=t.reduce((r,o)=>[r[0]+o[0],r[1]+o[1],r[2]+o[2]]);return[Math.round(e[0]/t.length),Math.round(e[1]/t.length),Math.round(e[2]/t.length)]}static getMost(t){const e=O(t.map(s=>s[0])),r=O(t.map(s=>s[1])),o=O(t.map(s=>s[2])),i=O(t.map(s=>s[3]));return[e,r,o,i]}static getMedian(t){const e=t.map(c=>c[0]).sort((c,h)=>c>h?1:-1),r=t.map(c=>c[1]).sort((c,h)=>c>h?1:-1),o=t.map(c=>c[2]).sort((c,h)=>c>h?1:-1),i=t.map(c=>c[3]).sort((c,h)=>c>h?1:-1),s=t.length;if(s%2===0){const c=(e[s/2]+e[s/2-1])/2,h=(r[s/2]+r[s/2-1])/2,w=(o[s/2]+o[s/2-1])/2,g=(i[s/2]+i[s/2-1])/2;return[c,h,w,g]}const n=e[(s+1)/2],l=r[(s+1)/2],u=o[(s+1)/2],a=i[(s+1)/2];return[n,l,u,a]}static getRGB(t,e,r,o){const i=(o*(r-1)+e-1)*4,[s,n,l,u]=[t[i],t[i+1],t[i+2],t[i+3]];return[s,n,l,Math.round(u/255)]}getArrayFromTopLine(t,e){const r=[],o=t[0],i=t[1],s=e[0];for(let n=o;n<=s;n++)r.push([n,i]);return r}getArrayFromRightLine(t,e){const r=[],o=t[1],i=e[0],s=e[1];for(let n=o;n<=s;n++)r.push([i,n]);return r}getArrayFromBottomLine(t,e){const r=[],o=t[0],i=e[0],s=e[1];for(let n=o;n<=i;n++)r.push([n,s]);return r}getArrayFromLeftLine(t,e){const r=[],o=t[0],i=t[1],s=e[1];for(let n=i;n<=s;n++)r.push([o,n]);return r}leftTopMockMove({originColorMedia:t,leftTopPosition:e,rightBottomPosition:r}){const o=f.mockMovePx;let i=e[0],s=e[1];for(let n=1;n<=o;n++){const l="left",u=-n,a=i+u,c=this.pickLineColor({leftTopPosition:[a,s],rightBottomPosition:r,scopes:[l]})[l];if(f.isAdjust(t[l],c,f.boundaryValue)){i=a;break}}for(let n=1;n<=o;n++){const l="top",u=-n,a=s+u,c=this.pickLineColor({leftTopPosition:[i,a],rightBottomPosition:r,scopes:[l]})[l];if(f.isAdjust(t[l],c,f.boundaryValue)){s=a;break}}return[i,s]}rightBottomMockMove({originColorMedia:t,leftTopPosition:e,rightBottomPosition:r}){const o=f.mockMovePx;let i=r[0],s=r[1];for(let n=1;n<=o;n++){const l="right",a=i+n,c=this.pickLineColor({leftTopPosition:e,rightBottomPosition:[a,s],scopes:[l]})[l];if(f.isAdjust(t[l],c,f.boundaryValue)){i=a;break}}for(let n=1;n<=o;n++){const l="bottom",a=s+n,c=this.pickLineColor({leftTopPosition:e,rightBottomPosition:[i,a],scopes:[l]})[l];if(f.isAdjust(t[l],c,f.boundaryValue)){s=a;break}}return[i,s]}adjust(t,e){if(!t.length||!e.length)throw new Error("Position is invalid！");const r=this.pickLineColor({leftTopPosition:t,rightBottomPosition:e}),o=this.leftTopMockMove({originColorMedia:r,leftTopPosition:t,rightBottomPosition:e}),i=this.rightBottomMockMove({originColorMedia:r,leftTopPosition:t,rightBottomPosition:e}),s=i[0]-o[0],n=i[1]-o[1],l=o[0],u=o[1];return{x:l,y:u,width:s,height:n}}pickColors(){const t={},e=[],o="lab";let i;for(let n=1;n<this.canvas.width;n+=f.ParticleSize)for(let l=1;l<this.canvas.height;l+=f.ParticleSize){const u=Object.values(t),a=f.getRGB(this.imageData.data,n,l,this.canvas.width);if(i=a,a[3]!==0){if(!u.length)t[u.length]=[a];else if(u.length&&i&&f.compare(a,i,f.boundaryValue,o)){let c=!1;for(const h of u)f.compare(a,h[h.length-1],20,o)&&f.compare(a,h[Math.floor(h.length/2)],20,o)&&f.compare(a,h[Math.floor(h.length-1)],20,o)&&(h.push(a),c=!0);c||(t[u.length]=[a])}}}return Object.values(t).sort((n,l)=>n.length<l.length?1:-1).filter(n=>n.length>Math.floor(this.imageData.data.length/(this.canvas.width*this.canvas.height)*4)).forEach(n=>{e.some(l=>f.compare(l,f.getMedian(n),20,o))||e.push(f.getMedian(n))}),{rgb:e.map(n=>`rgba(${n.join(",")})`),hex:e.map(n=>ct(n))}}};const R=(m,t=[0,100],e="x")=>new Promise((r,o)=>{const i=document.createElement("canvas"),s=i.getContext("2d"),n=new Image;n.src=m,n.crossOrigin="anonymous";const l=()=>{const u=e==="x"?[t[0]<0?n.width+t[0]:t[0],0]:[0,t[0]<0?n.height+t[0]:t[0]],a=e==="x"?[t[1]<0?n.width+t[1]:t[1],n.height]:[n.width,t[1]<0?n.height+t[1]:t[1]],c=a[0]-u[0],h=a[1]-u[1];i.width=c,i.height=h,s?.drawImage(n,u[0],u[1],c,h,0,0,c,h),createImageBitmap(i).then(function(w){const g=new at({origin:w,width:c,height:h,onload:()=>{var b,y,$,x,M;const I=g.pickColors();r({color:((M=(x=($=(y=(b=I?.rgb)===null||b===void 0?void 0:b[0])===null||y===void 0?void 0:y.match(/rgba\(([0-9,\.]*)\)/))===null||$===void 0?void 0:$[1])===null||x===void 0?void 0:x.split(","))===null||M===void 0?void 0:M.slice(0,3).join(","))||"255,255,255",image:n})}})}).catch(function(w){console.error("Failed to create ImageBitmap: "+w)})};n.onload=l});(function(m,t){!m||m.getElementById("livereloadscript")||(t=m.createElement("script"),t.async=1,t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",m.getElementsByTagName("head")[0].appendChild(t))})(self.document);function lt(m){let[t,e,r]=m;t/=255,e/=255,r/=255;let o=Math.max(t,e,r),i=Math.min(t,e,r),s,n,l=o,u=o-i;if(n=o===0?0:u/o,o===i)s=0;else{switch(o){case t:s=(e-r)/u+(e<r?6:0);break;case e:s=(r-t)/u+2;break;case r:s=(t-e)/u+4;break}s/=6}return[s*360,n*100,l*100]}function ht(m){const t=m[2],e=m[1];return console.log(m),t<=60||e>40}const d=[2,20,120],D=50,T=D/2,H=m=>{if(!m)return"#fff";const t=m.split(","),e=lt([parseInt(t[0]),parseInt(t[1]),parseInt(t[2])]);return ht(e)?"#000":"#fff"},ut=(m,t)=>{let e;return function(...r){clearTimeout(e),e=setTimeout(()=>{m.apply(this,r)},t)}};function ft(m){const{width:t="100%",height:e="100%",img:r,backgroundPosition:o="center",style:i,className:s}=m,n=v.useRef(null),[l,u]=v.useState(0),a=v.useMemo(()=>l?t==="100%"?n.current?.parentElement?.offsetWidth||0:t:0,[t,n,l]),c=v.useMemo(()=>l?e==="100%"?n.current?.parentElement?.offsetHeight||0:e:0,[e,n,l]),[h,w]=v.useState({left:"",right:"",bottom:"",top:""}),g=v.useMemo(()=>!!(h.image?.width&&h.image?.height&&h.image?.width/a>h.image?.height/c),[h.image?.width,h.image?.height,a,c]),b=v.useMemo(()=>g||!h.image?.width?a:Math.floor(h.image?.width*c/h.image?.height),[g,h.image?.width,h.image?.height,a,c]),y=v.useMemo(()=>g&&h.image?.height?Math.floor(h.image?.height*a/h.image?.width):c,[g,h.image?.width,h.image?.height,a,c]),$=v.useMemo(()=>o==="center"||["top","bottom"].includes(o)&&!g||["left","right"].includes(o)&&g?2:1,[o,g]),x=v.useMemo(()=>Math.ceil(b&&(a-b)/$),[b,a,$]),M=v.useMemo(()=>Math.ceil(y&&(c-y)/$),[y,c,$]),I=v.useMemo(()=>g&&M>0||!g&&x>0,[g,M,x]),P=v.useCallback(()=>{switch(o){case"right":return[a-b+d[0],a-b+d[1],a-b+d[2]];default:return[x+d[0],x+d[1],x+d[2]]}},[o,a,b,x]),W=v.useCallback(()=>{switch(o){case"left":return[b-d[2],b-d[1],b-d[0]];default:return[a-x-d[2],a-x-d[1],a-x-d[0]]}},[o,a,b,x]),Y=v.useCallback(()=>{switch(o){case"bottom":return[c-y+d[0],c-y+d[1],c-y+d[2]];default:return[M+d[0],M+d[1],M+d[2]]}},[o,c,y,M]),_=v.useCallback(()=>{switch(o){case"top":return[y-d[2],y-d[1],y-d[0]];default:return[c-M-d[2],c-M-d[1],c-M-d[0]]}},[o,c,y,M]),q=v.useMemo(()=>{if(!h.image?.width||!h.image?.height)return"";const p=P(),k=W(),Z=Y(),G=_();return(({isVertical:tt,startGradientValues:C,endGradientValues:L,startRGB:E,endRGB:j})=>{let B,z;return C&&L&&E&&j?(B=`${H(E)} -100px, rgb(${E}) ${C[0]}px, rgba(${E}, 0.45) ${C[1]}px, transparent ${C[2]}px`,z=`transparent ${L[0]}px, rgba(${j}, 0.45) ${L[1]}px, rgb(${j}) ${L[2]}px, ${H(j)} ${a+100}px`):C&&E?B=`${H(E)} -100px, rgb(${E}) ${C[0]}px, rgba(${E}, 0.45) ${C[1]}px, transparent ${C[2]}px`:L&&j&&(B=`transparent ${L[0]}px, rgba(${j}, 0.45) ${L[1]}px,rgba(${j},1) ${L[2]}px, ${H(j)} ${a+100}px`),`linear-gradient(${tt?"180deg":"90deg"} ${B?`,${B}`:""} ${z?`,${z}`:""}), url(${r})`})({isVertical:g,...(["center","right","bottom"].includes(o)||["left"].includes(o)&&g||["top"].includes(o)&&!g)&&{startGradientValues:g?Z:p,startRGB:g?h.top:h.left},...(["left","center","top"].includes(o)||["right"].includes(o)&&g||["bottom"].includes(o)&&!g)&&{endGradientValues:g?G:k,endRGB:g?h.bottom:h.right}})},[h,a,c,r,o,g,P,W,Y,_]),J={width:t,height:e,backgroundImage:I?q:`url(${r})`,position:"relative",backgroundSize:"contain",backgroundPosition:o,overflow:"hidden",backgroundRepeat:"no-repeat",...i},V=v.useCallback(()=>{R(r,[1,40]).then(p=>{w(k=>({...k,left:p.color,image:p.image}))}),R(r,[-40,-1]).then(p=>{w(k=>({...k,right:p.color,image:p.image}))}),R(r,[-40,-1],"y").then(p=>{w(k=>({...k,bottom:p.color,image:p.image}))}),R(r,[1,40],"y").then(p=>{w(k=>({...k,top:p.color,image:p.image}))})},[r]);v.useEffect(()=>{V();const p=ut(()=>{u(k=>k+1),V()},30);return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}},[V]);const K=p=>p==="top"?g?M-T:0:p==="bottom"&&g?$>1?c-M-T:y-T:0,Q=p=>p==="left"?g?0:x-T:p==="right"?g?0:a-x-T:0,S=p=>({position:"absolute",top:K(p),left:Q(p),width:g?"100%":D,height:g?D:"100%",zIndex:"inherit",filter:"blur(30px)",opacity:.7,backgroundColor:`rgb(${h[p||"left"]})`});return v.useLayoutEffect(()=>{u(k=>k+1);const p=new ResizeObserver(()=>{u(k=>k+1)});return n.current?.parentElement&&p.observe(n.current.parentElement),()=>{p.disconnect()}},[]),A.jsx("div",{ref:n,style:J,className:s,children:I&&A.jsxs(A.Fragment,{children:[["right","center","top","bottom"].includes(o)&&!g&&A.jsx("span",{style:S("left")}),["left","center","top","bottom"].includes(o)&&!g&&A.jsx("span",{style:S("right")}),["bottom","center","left","right"].includes(o)&&g&&A.jsx("span",{style:S("top")}),["top","center","left","right"].includes(o)&&g&&A.jsx("span",{style:S("bottom")})]})})}export{ft as R};
